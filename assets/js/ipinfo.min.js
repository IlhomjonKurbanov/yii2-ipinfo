/*!
 * @copyright Copyright &copy; Kartik Visweswaran, Krajee.com, 2015 - 2016
 * @version 1.0.0
 *
 * Krajee IP Information fetcher plugin using PHP API from freegeoip.net. The plugin is built to work with
 * `kartik-v/yii2-ipinfo` extension. The plugin refreshes IP information via AJAX on document load.
 *
 * @see http://api.freegeoip.net
 *
 * Author: Kartik Visweswaran
 * Copyright: 2015, Kartik Visweswaran, Krajee.com
 * For more JQuery plugins visit http://plugins.krajee.com
 * For more Yii related demos visit http://demos.krajee.com
 */!function(t){"use strict";var e=function(e,n){var a=this;a.$element=t(e),a.init(n)};e.prototype={constructor:e,init:function(e){var n=this,a=n.$element;t.each(e,function(t,e){n[t]=e}),t.ajax({url:n.url,type:"GET",dataType:"json",data:n.params,beforeSend:function(t){a.trigger("beforesend.kvipinfo",[t])},success:function(e,r,o){var i,f,p,s,l,c,d=e,u="",m=d.country_code;a.trigger("success.kvipinfo",[e,r,o]),d&&m?(n.flagWrapper&&(s=t.isEmptyObject(n.flagOptions)?{}:n.flagOptions,l="flag-icon-"+m.toLowerCase(),p=t(document.createElement("span")).attr(s).removeClass(l).addClass(l),t("#"+n.flagWrapper).html("").append(p)),t.each(n.fields,function(e,a){void 0!==d[a]&&(u+="<tr><th>"+n.defaultFields[a]+"</th><td>"+d[a]+"</td></tr>\n",c=t("#"+n.$element.attr("id")+"-"+a),c.length&&c.html(d[a]))}),u?(i=t(document.createElement("table")).attr(n.contentOptions).append(u),f=t(document.createElement("span")).append(i),a.html(f.html()),f.remove()):a.html(n.noData)):a.html(n.noData)},error:function(t,e,r){a.trigger("error.kvipinfo",[t,e,r]).html(n.errorData)}})}},t.fn.kvIpInfo=function(n){var a=Array.apply(null,arguments);return a.shift(),this.each(function(){var r,o=t(this),i=o.data("kvIpInfo"),f="object"==typeof n&&n;i||(r=t.extend({},t.fn.kvIpInfo.defaults),i=new e(this,t.extend(r,f,o.data())),o.data("kvIpInfo",i)),"string"==typeof n&&i[n].apply(i,a)})},t.fn.kvIpInfo.defaults={flagWrapper:"",flagOptions:{},fields:[],defaultFields:{},url:"",params:{},contentOptions:{},noData:"",errorData:""},t.fn.kvIpInfo.Constructor=e}(window.jQuery);